<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>沖繩旅遊景點地圖</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #0066cc;
            text-align: center;
            margin-bottom: 30px;
        }
        .map-container {
            width: 100%;
            height: 600px;
            margin-bottom: 30px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .legend {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .legend h3 {
            margin-top: 0;
            color: #333;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 50%;
        }
        .transportation { background-color: #FF5252; } /* 紅色 - 交通樞紐 */
        .accommodation { background-color: #4CAF50; } /* 綠色 - 住宿 */
        .shopping { background-color: #2196F3; } /* 藍色 - 購物中心 */
        .attraction { background-color: #FF9800; } /* 橙色 - 觀光景點 */
        .market { background-color: #9C27B0; } /* 紫色 - 漁市場 */
        .food { background-color: #795548; } /* 棕色 - 美食 */
        .back-button {
            display: block;
            text-align: center;
            margin-top: 20px;
        }
        .back-button a {
            display: inline-block;
            padding: 10px 20px;
            background-color: #0066cc;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .back-button a:hover {
            background-color: #0055aa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>沖繩旅遊景點地圖</h1>
        
        <div class="legend">
            <h3>類別圖例</h3>
            <div class="legend-item">
                <div class="legend-color transportation"></div>
                <span>交通樞紐</span>
            </div>
            <div class="legend-item">
                <div class="legend-color accommodation"></div>
                <span>住宿</span>
            </div>
            <div class="legend-item">
                <div class="legend-color shopping"></div>
                <span>購物中心</span>
            </div>
            <div class="legend-item">
                <div class="legend-color attraction"></div>
                <span>觀光景點</span>
            </div>
            <div class="legend-item">
                <div class="legend-color market"></div>
                <span>漁市場</span>
            </div>
            <div class="legend-item">
                <div class="legend-color food"></div>
                <span>美食</span>
            </div>
        </div>
        
        <div class="map-container" id="map"></div>
        
        <div class="back-button">
            <a href="text.txt">查看詳細景點資訊</a>
            <a href="okinawa_snorkeling_for_seniors.html" style="margin-left: 20px;">適合長者的浮潛/潛水行程</a>
        </div>
        
        <div class="location-list">
            <h2>沖繩旅遊景點列表</h2>
            <div class="markdown-content">
<pre>
## 交通樞紐
- **沖繩那霸機場** - 沖繩主要國際機場，營業時間：24小時
- **OTS租車** - 營業時間：08:00～19:00

## 住宿
- **沖繩逸之彩溫泉度假飯店** - 靠近牧志站的溫泉飯店

## 購物中心
- **MaxValu Makishi** - 24小時營業的大型超市
- **RYUBO nishimachi** - 營業時間：10:00～20:30
- **SAN-A 那霸Main Place** - 營業時間：10:00～22:00，那霸市最大購物商場，適合買伴手禮
- **ASHIBINAA 奧特萊斯** - 營業時間：10:00～20:00，沖繩最大的奧特萊斯商場
- **永旺夢樂城沖繩來客夢** - 營業時間：10:00～22:00
- **唐吉軻德（美國村店）** - 24小時營業
- **大國藥妝（國際通店）** - 營業時間：10:00～23:00
- **唐吉訶德 國際通店** - 營業時間：09:00～05:00
- **大國藥妝 新都心店** - 靠近那霸Main Place

## 觀光景點
- **美國村** - 充滿美式風情的購物娛樂區
- **美麗海水族館** - 營業時間：8:30～18:30
- **古宇利島** - 以美麗海灘和跨海大橋聞名的小島
- **波上宮** - 沖繩著名的神社，位於那霸市
- **透明獨木舟** - 透明獨木舟體驗，可欣賞海底美景

## 漁市場
- **牧志海鮮市場** - 營業時間：8:00～18:00
- **泊港漁市場** - 營業時間：6:00～18:00
- **系滿漁市場** - 營業時間：10:00～19:00

## 美食
- **暖暮拉麵** - 著名的沖繩拉麵店，位於國際通附近
- **蝦蝦飯** - 提供新鮮蝦料理的餐廳
- **Pork Tamago Onigiri** - 著名的豬肉蛋飯糰店，常有排隊人潮
- **Kazuki壽喜燒** - 高品質的沖繩壽喜燒餐廳
</pre>
            </div>
        </div>
    </div>
    
    <style>
        .location-list {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }
        .location-list h2 {
            color: #0066cc;
            margin-bottom: 20px;
        }
        .markdown-content {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            line-height: 1.6;
        }
        .markdown-content pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
        }
        .markdown-content strong {
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            padding: 0 2px;
            border-radius: 3px;
        }
        .markdown-content strong:hover {
            color: #0066cc;
            text-decoration: underline;
            background-color: rgba(0, 102, 204, 0.1);
        }
        .markdown-content strong.has-marker {
            border-bottom: 1px dashed #0066cc;
        }
    </style>

    <script>
        function initMap() {
            // 創建地圖，中心設在沖繩中部
            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 9,
                center: { lat: 26.336, lng: 127.802 },
            });

            // 定義地點資訊
            const locations = [
                // 交通樞紐
                { name: "沖繩那霸機場", lat: 26.1958, lng: 127.6455, category: "transportation", info: "沖繩主要國際機場，營業時間：24小時" },
                { name: "OTS租車", lat: 26.1714, lng: 127.6486, category: "transportation", info: "營業時間：08:00～19:00" },
                
                // 住宿
                { name: "沖繩逸之彩溫泉度假飯店", lat: 26.2170, lng: 127.6890, category: "accommodation", info: "靠近牧志站的溫泉飯店" },
                
                // 購物中心
                { name: "MaxValu Makishi", lat: 26.2144, lng: 127.6769, category: "shopping", info: "24小時營業的大型超市" },
                { name: "RYUBO nishimachi", lat: 26.2173, lng: 127.6790, category: "shopping", info: "營業時間：10:00～20:30" },
                { name: "SAN-A 那霸Main Place", lat: 26.2253, lng: 127.6976, category: "shopping", info: "營業時間：10:00～22:00，那霸市最大購物商場，適合買伴手禮" },
                { name: "ASHIBINAA 奧特萊斯", lat: 26.1619, lng: 127.6624, category: "shopping", info: "營業時間：10:00～20:00，沖繩最大的奧特萊斯商場" },
                { name: "永旺夢樂城沖繩來客夢", lat: 26.3016, lng: 127.7927, category: "shopping", info: "營業時間：10:00～22:00" },
                { name: "唐吉軻德（美國村店）", lat: 26.3167, lng: 127.7575, category: "shopping", info: "24小時營業" },
                { name: "大國藥妝（國際通店）", lat: 26.2144, lng: 127.6800, category: "shopping", info: "營業時間：10:00～23:00" },
                { name: "唐吉訶德 國際通店", lat: 26.2150, lng: 127.6840, category: "shopping", info: "營業時間：09:00～05:00" },
                { name: "大國藥妝 新都心店", lat: 26.2270, lng: 127.6970, category: "shopping", info: "靠近那霸Main Place" },
                
                // 觀光景點
                { name: "美國村", lat: 26.3167, lng: 127.7575, category: "attraction", info: "充滿美式風情的購物娛樂區" },
                { name: "美麗海水族館", lat: 26.6941, lng: 127.8780, category: "attraction", info: "營業時間：8:30～18:30" },
                { name: "古宇利島", lat: 26.6942, lng: 128.0171, category: "attraction", info: "以美麗海灘和跨海大橋聞名的小島" },
                { name: "波上宮", lat: 26.2225, lng: 127.6673, category: "attraction", info: "沖繩著名的神社，位於那霸市" },
                { name: "透明獨木舟", lat: 26.5158, lng: 127.9253, category: "attraction", info: "透明獨木舟體驗，可欣賞海底美景" },
                
                // 漁市場
                { name: "牧志海鮮市場", lat: 26.2166, lng: 127.6900, category: "market", info: "營業時間：8:00～18:00" },
                { name: "泊港漁市場", lat: 26.2289, lng: 127.6731, category: "market", info: "營業時間：6:00～18:00" },
                { name: "系滿漁市場", lat: 26.0961, lng: 127.6686, category: "market", info: "營業時間：10:00～19:00" },
                
                // 美食
                { name: "暖暮拉麵", lat: 26.2158, lng: 127.6794, category: "food", info: "著名的沖繩拉麵店，位於國際通附近" },
                { name: "蝦蝦飯", lat: 26.2163, lng: 127.6789, category: "food", info: "提供新鮮蝦料理的餐廳" },
                { name: "Pork Tamago Onigiri", lat: 26.2169, lng: 127.6793, category: "food", info: "著名的豬肉蛋飯糰店，常有排隊人潮" },
                { name: "Kazuki壽喜燒", lat: 26.2180, lng: 127.6810, category: "food", info: "高品質的沖繩壽喜燒餐廳" }
            ];

            // 為每個地點添加標記
            locations.forEach(location => {
                // 根據類別選擇標記顏色
                let markerColor;
                switch(location.category) {
                    case "transportation":
                        markerColor = "#FF5252"; // 紅色 - 交通樞紐
                        break;
                    case "accommodation":
                        markerColor = "#4CAF50"; // 綠色 - 住宿
                        break;
                    case "shopping":
                        markerColor = "#2196F3"; // 藍色 - 購物中心
                        break;
                    case "attraction":
                        markerColor = "#FF9800"; // 橙色 - 觀光景點
                        break;
                    case "market":
                        markerColor = "#9C27B0"; // 紫色 - 漁市場
                        break;
                    case "food":
                        markerColor = "#795548"; // 棕色 - 美食
                        break;
                    default:
                        markerColor = "#9E9E9E"; // 灰色
                }
                
                // 創建標記
                const marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.name,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        fillColor: markerColor,
                        fillOpacity: 0.9,
                        strokeWeight: 2,
                        strokeColor: "#ffffff",
                        scale: 10
                    }
                });
                
                // 添加信息窗口
                const infoWindow = new google.maps.InfoWindow({
                    content: `<div style="padding: 10px;">
                                <h3 style="margin-top: 0;">${location.name}</h3>
                                <p>${location.info}</p>
                              </div>`
                });
                
                // 點擊標記時顯示信息窗口
                marker.addListener("click", () => {
                    infoWindow.open(map, marker);
                });
            });
        }
    </script>
    <!-- 使用Leaflet作為替代地圖解決方案，不需要API密鑰 -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        // 創建一個全局對象來存儲所有標記和地圖，以便後續引用
        let markers = {};
        let map;
        
        function initMap() {
            // 創建Leaflet地圖，中心設在沖繩中部
            map = L.map('map').setView([26.336, 127.802], 9);
            
            // 添加OpenStreetMap圖層
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // 定義地點資訊
            const locations = [
                // 交通樞紐
                { name: "沖繩那霸機場", lat: 26.1958, lng: 127.6455, category: "transportation", info: "沖繩主要國際機場，營業時間：24小時" },
                { name: "OTS租車", lat: 26.1714, lng: 127.6486, category: "transportation", info: "營業時間：08:00～19:00" },
                
                // 住宿
                { name: "沖繩逸之彩溫泉度假飯店", lat: 26.2170, lng: 127.6890, category: "accommodation", info: "靠近牧志站的溫泉飯店" },
                
                // 購物中心
                { name: "MaxValu Makishi", lat: 26.2144, lng: 127.6769, category: "shopping", info: "24小時營業的大型超市" },
                { name: "RYUBO nishimachi", lat: 26.2173, lng: 127.6790, category: "shopping", info: "營業時間：10:00～20:30" },
                { name: "SAN-A 那霸Main Place", lat: 26.2253, lng: 127.6976, category: "shopping", info: "營業時間：10:00～22:00，那霸市最大購物商場，適合買伴手禮" },
                { name: "ASHIBINAA 奧特萊斯", lat: 26.1619, lng: 127.6624, category: "shopping", info: "營業時間：10:00～20:00，沖繩最大的奧特萊斯商場" },
                { name: "永旺夢樂城沖繩來客夢", lat: 26.3016, lng: 127.7927, category: "shopping", info: "營業時間：10:00～22:00" },
                { name: "唐吉軻德（美國村店）", lat: 26.3167, lng: 127.7575, category: "shopping", info: "24小時營業" },
                { name: "大國藥妝（國際通店）", lat: 26.2144, lng: 127.6800, category: "shopping", info: "營業時間：10:00～23:00" },
                { name: "唐吉訶德 國際通店", lat: 26.2150, lng: 127.6840, category: "shopping", info: "營業時間：09:00～05:00" },
                { name: "大國藥妝 新都心店", lat: 26.2270, lng: 127.6970, category: "shopping", info: "靠近那霸Main Place" },
                
                // 觀光景點
                { name: "美國村", lat: 26.3167, lng: 127.7575, category: "attraction", info: "充滿美式風情的購物娛樂區" },
                { name: "美麗海水族館", lat: 26.6941, lng: 127.8780, category: "attraction", info: "營業時間：8:30～18:30" },
                { name: "古宇利島", lat: 26.6942, lng: 128.0171, category: "attraction", info: "以美麗海灘和跨海大橋聞名的小島" },
                { name: "波上宮", lat: 26.2225, lng: 127.6673, category: "attraction", info: "沖繩著名的神社，位於那霸市" },
                { name: "透明獨木舟", lat: 26.5158, lng: 127.9253, category: "attraction", info: "透明獨木舟體驗，可欣賞海底美景" },
                
                // 漁市場
                { name: "牧志海鮮市場", lat: 26.2166, lng: 127.6900, category: "market", info: "營業時間：8:00～18:00" },
                { name: "泊港漁市場", lat: 26.2289, lng: 127.6731, category: "market", info: "營業時間：6:00～18:00" },
                { name: "系滿漁市場", lat: 26.0961, lng: 127.6686, category: "market", info: "營業時間：10:00～19:00" },
                
                // 美食
                { name: "暖暮拉麵", lat: 26.2158, lng: 127.6794, category: "food", info: "著名的沖繩拉麵店，位於國際通附近" },
                { name: "蝦蝦飯", lat: 26.2163, lng: 127.6789, category: "food", info: "提供新鮮蝦料理的餐廳" },
                { name: "Pork Tamago Onigiri", lat: 26.2169, lng: 127.6793, category: "food", info: "著名的豬肉蛋飯糰店，常有排隊人潮" },
                { name: "Kazuki壽喜燒", lat: 26.2180, lng: 127.6810, category: "food", info: "高品質的沖繩壽喜燒餐廳" }
            ];

            // 為每個地點添加標記
            locations.forEach(location => {
                // 根據類別選擇標記顏色
                let markerColor;
                switch(location.category) {
                    case "transportation":
                        markerColor = "#FF5252"; // 紅色 - 交通樞紐
                        break;
                    case "accommodation":
                        markerColor = "#4CAF50"; // 綠色 - 住宿
                        break;
                    case "shopping":
                        markerColor = "#2196F3"; // 藍色 - 購物中心
                        break;
                    case "attraction":
                        markerColor = "#FF9800"; // 橙色 - 觀光景點
                        break;
                    case "market":
                        markerColor = "#9C27B0"; // 紫色 - 漁市場
                        break;
                    case "food":
                        markerColor = "#795548"; // 棕色 - 美食
                        break;
                    default:
                        markerColor = "#9E9E9E"; // 灰色
                }
                
                // 創建自定義圖標
                const markerIcon = L.divIcon({
                    className: 'custom-div-icon',
                    html: `<div style="background-color: ${markerColor}; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white;"></div>`,
                    iconSize: [24, 24],
                    iconAnchor: [12, 12]
                });
                
                // 創建標記
                const marker = L.marker([location.lat, location.lng], {icon: markerIcon})
                    .addTo(map);
                
                // 添加彈出信息窗口
                marker.bindPopup(`<div style="padding: 10px;">
                                <h3 style="margin-top: 0;">${location.name}</h3>
                                <p>${location.info}</p>
                              </div>`);
                              
                // 將標記存儲在markers對象中，以便後續引用
                markers[location.name] = marker;
            });
        }

        // 頁面加載完成後初始化地圖和添加景點列表點擊事件
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化地圖
            initMap();
            
            // 添加景點列表點擊事件
            setTimeout(function() {
                // 獲取所有景點名稱元素
                const locationNames = document.querySelectorAll('.markdown-content strong');
                console.log('找到景點名稱元素數量:', locationNames.length);
                
                // 為每個景點名稱添加點擊事件
                locationNames.forEach(element => {
                    const locationName = element.textContent.trim();
                    
                    // 尋找匹配的標記（不區分大小寫和括號內容）
                    let marker = null;
                    const simplifiedName = locationName.replace(/（.*?）|\(.*?\)/g, '').trim();
                    
                    // 嘗試直接匹配
                    if (markers[locationName]) {
                        marker = markers[locationName];
                    } 
                    // 嘗試簡化名稱匹配
                    else {
                        // 將景點名稱轉換為小寫以進行不區分大小寫的比較
                        const lowerSimplifiedName = simplifiedName.toLowerCase();
                        
                        const markerKey = Object.keys(markers).find(key => {
                            // 將標記名稱轉換為小寫並移除括號內容
                            const simplifiedKey = key.replace(/（.*?）|\(.*?\)/g, '').trim().toLowerCase();
                            
                            // 檢查是否完全匹配、包含關係或部分匹配
                            return simplifiedKey === lowerSimplifiedName || 
                                   key.toLowerCase().includes(lowerSimplifiedName) || 
                                   lowerSimplifiedName.includes(simplifiedKey);
                        });
                        
                        if (markerKey) {
                            marker = markers[markerKey];
                        }
                    }
                    
                    // 如果找到匹配的標記，添加視覺提示和點擊事件
                    if (marker) {
                        console.log('成功匹配景點:', locationName);
                        
                        // 添加視覺提示類別
                        element.classList.add('has-marker');
                        
                        // 添加點擊事件
                        element.addEventListener('click', function(e) {
                            e.preventDefault();
                            console.log('點擊了景點:', locationName);
                            
                            // 將地圖中心設置為標記位置
                            map.setView(marker.getLatLng(), 13);
                            
                            // 打開彈出窗口
                            marker.openPopup();
                            
                            // 滾動到地圖位置
                            document.getElementById('map').scrollIntoView({behavior: 'smooth'});
                        });
                    } else {
                        console.log('未找到匹配標記:', locationName);
                    }
                });
                
                // 添加調試信息
                console.log('可用的標記:', Object.keys(markers));
            }, 1000); // 延遲1秒，確保地圖和標記已完全加載
        });
    </script>
</body>
</html>